<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®€å•æµ‹è¯•é¡µé¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            min-height: 100vh;
        }
        .container {
            max-width: 400px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 20px;
        }
        .test-item {
            background: #f5f5f5;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #4CAF50;
        }
        .error {
            border-left-color: #f44336;
            background: #ffebee;
        }
        .button {
            width: 100%;
            padding: 15px;
            background: #2196F3;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px 0;
        }
        .button:hover {
            background: #1976D2;
        }
        #result {
            margin-top: 20px;
            padding: 15px;
            background: #e3f2fd;
            border-radius: 5px;
            white-space: pre-wrap;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ åŸºç¡€æµ‹è¯•é¡µé¢</h1>
        
        <div class="test-item">
            <strong>âœ… HTMLåŠ è½½æˆåŠŸ</strong><br>
            å¦‚æœæ‚¨èƒ½çœ‹åˆ°è¿™ä¸ªé¡µé¢ï¼Œè¯´æ˜é™æ€æ–‡ä»¶åŠ è½½æ­£å¸¸
        </div>
        
        <div class="test-item" id="jsTest">
            <strong>â³ JavaScriptæµ‹è¯•</strong><br>
            æ­£åœ¨æ£€æµ‹JavaScriptæ˜¯å¦æ­£å¸¸å·¥ä½œ...
        </div>
        
        <div class="test-item" id="fetchTest">
            <strong>â³ ç½‘ç»œæµ‹è¯•</strong><br>
            æ­£åœ¨æµ‹è¯•ç½‘ç»œè¿æ¥...
        </div>
        
        <button class="button" onclick="testMainSite()">ğŸ  æµ‹è¯•ä¸»ç«™åŠ è½½</button>
        <button class="button" onclick="testAPI()">ğŸ”— æµ‹è¯•APIè¿æ¥</button>
        <button class="button" onclick="showDebugInfo()">ğŸ“± æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯</button>
        
        <div id="result"></div>
    </div>

    <script>
        // æµ‹è¯•JavaScript
        document.addEventListener('DOMContentLoaded', function() {
            const jsTest = document.getElementById('jsTest');
            try {
                jsTest.innerHTML = '<strong>âœ… JavaScriptæ­£å¸¸</strong><br>JavaScriptå¼•æ“å·¥ä½œæ­£å¸¸';
                jsTest.className = 'test-item';
                
                // æµ‹è¯•ç°ä»£JavaScriptç‰¹æ€§
                const testArrow = () => 'Arrow functions work';
                const testTemplate = `Template literals work`;
                const testPromise = new Promise(resolve => resolve('Promises work'));
                
                testNetworkConnection();
            } catch (error) {
                jsTest.innerHTML = `<strong>âŒ JavaScripté”™è¯¯</strong><br>${error.message}`;
                jsTest.className = 'test-item error';
            }
        });
        
        // æµ‹è¯•ç½‘ç»œè¿æ¥
        async function testNetworkConnection() {
            const fetchTest = document.getElementById('fetchTest');
            try {
                // æµ‹è¯•fetch API
                const response = await fetch('https://httpbin.org/get', {
                    method: 'GET',
                    timeout: 5000
                });
                
                if (response.ok) {
                    fetchTest.innerHTML = '<strong>âœ… ç½‘ç»œè¿æ¥æ­£å¸¸</strong><br>Fetch APIå·¥ä½œæ­£å¸¸ï¼Œå¯ä»¥è®¿é—®å¤–éƒ¨æœåŠ¡';
                    fetchTest.className = 'test-item';
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
            } catch (error) {
                fetchTest.innerHTML = `<strong>âŒ ç½‘ç»œè¿æ¥å¤±è´¥</strong><br>é”™è¯¯: ${error.message}`;
                fetchTest.className = 'test-item error';
            }
        }
        
        // æµ‹è¯•ä¸»ç«™
        async function testMainSite() {
            const result = document.getElementById('result');
            result.innerHTML = 'æ­£åœ¨æµ‹è¯•ä¸»ç«™åŠ è½½...\n';
            
            try {
                // å°è¯•åŠ è½½ä¸»ç«™çš„index.html
                const response = await fetch('/', {
                    method: 'GET',
                    cache: 'no-cache'
                });
                
                const text = await response.text();
                
                if (response.ok) {
                    result.innerHTML += `âœ… ä¸»ç«™å“åº”æ­£å¸¸\nçŠ¶æ€: ${response.status}\nå†…å®¹é•¿åº¦: ${text.length} å­—ç¬¦\n`;
                    
                    // æ£€æŸ¥æ˜¯å¦åŒ…å«Reactç›¸å…³å†…å®¹
                    if (text.includes('react') || text.includes('React') || text.includes('root')) {
                        result.innerHTML += 'âœ… å‘ç°Reactç›¸å…³å†…å®¹\n';
                    } else {
                        result.innerHTML += 'âš ï¸ æœªå‘ç°Reactç›¸å…³å†…å®¹\n';
                    }
                    
                    // æ£€æŸ¥JSæ–‡ä»¶å¼•ç”¨
                    const jsMatches = text.match(/src="[^"]*\.js"/g);
                    if (jsMatches) {
                        result.innerHTML += `ğŸ“„ å‘ç° ${jsMatches.length} ä¸ªJSæ–‡ä»¶å¼•ç”¨\n`;
                        jsMatches.forEach((match, index) => {
                            result.innerHTML += `  ${index + 1}. ${match}\n`;
                        });
                    } else {
                        result.innerHTML += 'âŒ æœªå‘ç°JSæ–‡ä»¶å¼•ç”¨\n';
                    }
                } else {
                    result.innerHTML += `âŒ ä¸»ç«™åŠ è½½å¤±è´¥\nçŠ¶æ€: ${response.status}\n`;
                }
            } catch (error) {
                result.innerHTML += `âŒ ä¸»ç«™è¿æ¥å¤±è´¥\né”™è¯¯: ${error.message}\n`;
            }
        }
        
        // æµ‹è¯•API
        async function testAPI() {
            const result = document.getElementById('result');
            result.innerHTML = 'æ­£åœ¨æµ‹è¯•APIè¿æ¥...\n';
            
            const apiUrl = 'https://converter-backend.qaz354073.workers.dev';
            
            try {
                // æµ‹è¯•åŸºç¡€è¿æ¥
                const response = await fetch(`${apiUrl}/api/convert/weight`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        amount: 1,
                        from: 'kg',
                        to: 'g'
                    })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    result.innerHTML += `âœ… APIè¿æ¥æˆåŠŸ\nç»“æœ: ${data.result}\n`;
                } else {
                    result.innerHTML += `âŒ APIè¿”å›é”™è¯¯\nçŠ¶æ€: ${response.status}\né”™è¯¯: ${data.error}\n`;
                }
            } catch (error) {
                result.innerHTML += `âŒ APIè¿æ¥å¤±è´¥\né”™è¯¯: ${error.message}\n`;
            }
        }
        
        // æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯
        function showDebugInfo() {
            const result = document.getElementById('result');
            const info = {
                'ç”¨æˆ·ä»£ç†': navigator.userAgent,
                'å¹³å°': navigator.platform,
                'è¯­è¨€': navigator.language,
                'åœ¨çº¿çŠ¶æ€': navigator.onLine ? 'åœ¨çº¿' : 'ç¦»çº¿',
                'Cookieå¯ç”¨': navigator.cookieEnabled ? 'æ˜¯' : 'å¦',
                'å±å¹•å°ºå¯¸': `${screen.width}x${screen.height}`,
                'è§†å£å°ºå¯¸': `${window.innerWidth}x${window.innerHeight}`,
                'è®¾å¤‡åƒç´ æ¯”': window.devicePixelRatio,
                'è§¦æ‘¸æ”¯æŒ': 'ontouchstart' in window ? 'æ˜¯' : 'å¦',
                'åè®®': location.protocol,
                'ä¸»æœº': location.host,
                'è·¯å¾„': location.pathname,
                'å½“å‰æ—¶é—´': new Date().toLocaleString()
            };
            
            // æ£€æµ‹ç½‘ç»œç±»å‹
            const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
            if (connection) {
                info['ç½‘ç»œç±»å‹'] = connection.effectiveType || 'æœªçŸ¥';
                info['ä¸‹è¡Œé€Ÿåº¦'] = connection.downlink ? `${connection.downlink} Mbps` : 'æœªçŸ¥';
                info['RTT'] = connection.rtt ? `${connection.rtt} ms` : 'æœªçŸ¥';
            }
            
            result.innerHTML = Object.entries(info)
                .map(([key, value]) => `${key}: ${value}`)
                .join('\n');
        }
    </script>
</body>
</html> 